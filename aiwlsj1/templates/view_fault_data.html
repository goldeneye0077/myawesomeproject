{% extends "base.html" %}

{% block title %}故障数据详情 - 网络视界指标后台管理{% endblock %}

{% block content %}
<!-- 故障数据详情卡片 -->
<div class="bg-white rounded-xl shadow-sm border border-gray-200">
    <div class="px-6 py-4 border-b border-gray-200 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4">
        <h2 class="text-xl font-semibold text-gray-900">故障数据详情</h2>
        <div class="flex flex-wrap gap-2">
            <a href="/fault/edit_fault_data/{{ fault_record.id }}" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">编辑</a>
            <a href="/fault/data" class="bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">返回列表</a>
        </div>
    </div>
    
    <div class="p-6">
        <!-- 基本信息 -->
        <div class="mb-8 bg-gray-50 border-l-4 border-blue-500 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">基本信息</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">序号</span>
                    <span class="text-gray-900">{{ fault_record.sequence_no or '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">故障日期</span>
                    <span class="text-gray-900">{{ fault_record.fault_date.strftime('%Y-%m-%d %H:%M:%S') if fault_record.fault_date else '-' }}</span>
                </div>
                <div class="flex flex-col md:col-span-2 lg:col-span-1">
                    <span class="text-sm font-medium text-gray-500 mb-1">故障名称</span>
                    <span class="text-gray-900 break-words">{{ fault_record.fault_name or '-' }}</span>
                </div>
            </div>
        </div>

        <!-- 分类信息 -->
        <div class="mb-8 bg-gray-50 border-l-4 border-green-500 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">分类信息</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">省-故障类型</span>
                    <span class="inline-block px-3 py-1 bg-cyan-100 text-cyan-800 text-sm font-medium rounded-full w-fit">{{ fault_record.province_fault_type or '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">原因分类</span>
                    <span class="inline-block px-3 py-1 bg-amber-100 text-amber-800 text-sm font-medium rounded-full w-fit">{{ fault_record.cause_category or '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">通报级别</span>
                    <span class="inline-block px-3 py-1 {% if fault_record.notification_level and ('重大' in fault_record.notification_level or '严重' in fault_record.notification_level) %}bg-red-100 text-red-800{% elif fault_record.notification_level and '一般' in fault_record.notification_level %}bg-yellow-100 text-yellow-800{% else %}bg-blue-100 text-blue-800{% endif %} text-sm font-medium rounded-full w-fit">
                        {{ fault_record.notification_level or '-' }}
                    </span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">省-原因分类</span>
                    <span class="text-gray-900">{{ fault_record.province_cause_category or '-' }}</span>
                </div>
            </div>
        </div>

        <!-- 时间信息 -->
        <div class="mb-8 bg-gray-50 border-l-4 border-purple-500 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">时间信息</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">发生时间</span>
                    <span class="text-gray-900">{{ fault_record.start_time.strftime('%Y-%m-%d %H:%M:%S') if fault_record.start_time else '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">结束时间</span>
                    <span class="text-gray-900">{{ fault_record.end_time.strftime('%Y-%m-%d %H:%M:%S') if fault_record.end_time else '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">故障处理时长</span>
                    <span class="text-gray-900">{{ "{:.2f}".format(fault_record.fault_duration_hours) if fault_record.fault_duration_hours else '-' }} 小时</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">主动发现</span>
                    <span class="inline-block px-3 py-1 {% if fault_record.is_proactive_discovery == '是' %}bg-green-100 text-green-800{% elif fault_record.is_proactive_discovery == '否' %}bg-gray-100 text-gray-800{% else %}bg-gray-50 text-gray-600{% endif %} text-sm font-medium rounded-full w-fit">
                        {{ fault_record.is_proactive_discovery or '-' }}
                    </span>
                </div>
            </div>
        </div>

        <!-- 详细描述 -->
        <div class="mb-8 bg-gray-50 border-l-4 border-orange-500 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">详细描述</h3>
            <div class="space-y-4">
                <div>
                    <span class="block text-sm font-medium text-gray-500 mb-2">省-故障原因分析</span>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 min-h-16">
                        <p class="text-gray-900 whitespace-pre-wrap">{{ fault_record.province_cause_analysis or '-' }}</p>
                    </div>
                </div>
                <div>
                    <span class="block text-sm font-medium text-gray-500 mb-2">故障原因</span>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 min-h-16">
                        <p class="text-gray-900 whitespace-pre-wrap">{{ fault_record.fault_cause or '-' }}</p>
                    </div>
                </div>
                <div>
                    <span class="block text-sm font-medium text-gray-500 mb-2">故障处理</span>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 min-h-16">
                        <p class="text-gray-900 whitespace-pre-wrap">{{ fault_record.fault_handling or '-' }}</p>
                    </div>
                </div>
                <div>
                    <span class="block text-sm font-medium text-gray-500 mb-2">投诉情况</span>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 min-h-16">
                        <p class="text-gray-900 whitespace-pre-wrap">{{ fault_record.complaint_situation or '-' }}</p>
                    </div>
                </div>
                <div>
                    <span class="block text-sm font-medium text-gray-500 mb-2">备注</span>
                    <div class="bg-white p-4 rounded-lg border border-gray-200 min-h-16">
                        <p class="text-gray-900 whitespace-pre-wrap">{{ fault_record.remarks or '-' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 系统信息 -->
        <div class="bg-gray-50 border-l-4 border-gray-500 rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">系统信息</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">创建时间</span>
                    <span class="text-gray-900 text-sm">{{ fault_record.created_at.strftime('%Y-%m-%d %H:%M:%S') if fault_record.created_at else '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">更新时间</span>
                    <span class="text-gray-900 text-sm">{{ fault_record.updated_at.strftime('%Y-%m-%d %H:%M:%S') if fault_record.updated_at else '-' }}</span>
                </div>
                <div class="flex flex-col">
                    <span class="text-sm font-medium text-gray-500 mb-1">记录ID</span>
                    <span class="text-gray-600 text-sm font-mono">{{ fault_record.id }}</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 移动端响应式调整样式 -->
<style>
@media (max-width: 768px) {
    .grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-3.gap-4,
    .grid.grid-cols-1.md\\:grid-cols-2.lg\\:grid-cols-4.gap-4,
    .grid.grid-cols-1.md\\:grid-cols-2.gap-4,
    .grid.grid-cols-1.md\\:grid-cols-3.gap-4 {
        grid-template-columns: 1fr !important;
    }
    
    .flex.flex-col.sm\\:flex-row.sm\\:justify-between.sm\\:items-center.gap-4 {
        align-items: flex-start !important;
    }
    
    .flex.flex-wrap.gap-2 {
        width: 100%;
        justify-content: stretch;
    }
    
    .flex.flex-wrap.gap-2 > a {
        flex: 1;
        text-align: center;
    }
    
    /* 确保详细描述区域在移动设备上能正确显示 */
    .whitespace-pre-wrap {
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
}

/* 自定义徽章样式，确保与背景色搭配良好 */
.w-fit {
    width: fit-content;
}

/* 确保长文本能够正确换行 */
.break-words {
    word-break: break-words;
    overflow-wrap: break-word;
}

/* 最小高度确保空内容时也有合理的显示区域 */
.min-h-16 {
    min-height: 4rem;
}
</style>
{% endblock %}